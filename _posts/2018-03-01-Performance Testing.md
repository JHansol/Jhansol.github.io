---
layout: post
title: Performance Testing 정리
tags: [Test, Ipsum, Markdown, Portfolio]
---

# Performance Testing 

-  성능 테스트는 사용자가 웹 서비스를 이용할때의 응답성을 알아볼 수 있는 테스트 유형중 하나이다. 이 과정을 통해 서비스의 처리량과 안전성, 확장성을 보장할 수 있다. 핵심 성능 테스트의 활동은 총 7가지의 과정으로 나누어진다. 첫번째 과정으로는 테스트 환경을 확인해야 한다. 테스트 팀이 도구와 리소스를 물리적 테스트 환경과 생산 환경에서도 사용할 수 있는지 확인해야 한다. 테스트 환경을 이해하면 효율적인 테스트 설계 및 계획이 가능하며 어떤 상황에서는 주기적으로 이 과정을 반드시 재 검토하기도 합니다.

  두번째 과정은 성능이 받아들일 수 있는 기준을 확인합니다. 응답시간과 처리량, 리소스 이용 목표와 제약조건을 확인하면 가장 원하는 성능의 설정 조합을 평가할 수 있습니다. 응답시간은 사용자의 관심사이고 처리량은 기능의 관심사이고 리소스 이용은 시스템의 관심사이다.

  세번째 과정은 계획과 설계를 테스트합니다.  시나리오를 구성하여 유저의 변화를 시뮬레이션 하는 방법과 테스트 데이터를 정의하고 수집합니다. 그리고 이 정보를 시스템에 사용할 모델로 통합하여 구현하고 실행, 분석합니다.

  네번째 과정은 테스트 환경을 구성합니다. 각 테스트에 실행될 요소들이 테스트 환경에 구성되어 있는지 확인 합니다. 

  다섯번째 과정은 테스트 설계를 구현합니다. 테스트 설계를 보고 성능 테스트를 개발합니다.

  여섯번째 과정은 테스트를 실행합니다. 테스트의 유효성을 검사하고 테스트합니다.

  일곱번째 과정은 결과와 레포트를 분석하고 재검사합니다. 결과 데이터를 공유하고 통합시킵니다. 

  성능 테스트를 왜 할까? 성능 테스트는 비용과 기회 비용, 기업의 평판과 같은 위험을 해결하기 위해 실시됩니다.

  - 출시 전 어플리케이션의 성능을 예측하고 이 예측을 통해 성능 문제를 평가할 수 있습니다. 이 예측들은 투자자들한테 가치가 있습니다. 투자자들은 어플리케이션이 출시될 준비가 되었는지, 또는 미래성장을 다루는 것에 능숙한지 또는 그것이 출시되기전에 성능 개선/ 하드웨어 업그레이드를 필요로 하는지에 대해 결정하는 사람들입니다
  - 이는 출시하기 전에 성능을 개선하거나 스케일업이 필요한지 아니면 출시 후에 해결할 수 있는지 알 수 있습니다. 
  - 시스템의 성능과 함께 유저의 불만족 같은 데이터를 제공합니다.
  - 확장성 또는 안정성 문제나 어플리케이션의 응답 시간에 불만족한 유저들때문에 브랜드의 신뢰도 손실이나 수익 손실의 예측에 도움되는 정보를 제공합니다.
  - 인프라 적합성을 평가합니다. 현재 수용량을 평가하거나 안정성을 수용하는지 결정하고 예산에 따른 자원 사용에 맞는 성능을 내는지 확인합니다.
  - 개발 전 후의 원하는 성능을 결정하고 현재 성능과 원하는 성능 특성의 비교를 제공합니다.
  - 다양한 부하 행동을 분석하고 병목 현상을 확인하면 성능을 향상 시킬 수 있습니다.

  프로젝트의 맥락을 파악하지 못하면 시간 낭비와 좌절과 충돌로 이어지게 된다. 프로젝트 맥락이란 프로젝트를 성공하는 것과 관련된 것들이며 프로젝트의 비전이나 의도, 성능 테스트 목표, 성과 기준, 프로젝트 예산, 생명 주기, 프로젝트 스케줄, 이용할 수 있는 환경과 도구, 팀의 기술, 성능 문제의 우선순위, 형편없이 실행되는 어플리케이션을 배포했을때의 비즈니스의 영향이다. 

  - 성능 테스트와 튜닝의 관계 : 팀은 필요한 하드웨어 용량을 줄이고, 플랫폼 여유 공간을 늘리기 위해 리소스의 양을 줄여 시스템 성능을 향상 시킨다. 팀간의 협력 없이는 성능문제를 효율적으로 해결하는 데 거의 불가능하다. 성능 테스터는 핵심 인력이며 다양한 부하 조건과 구성하에 응답 시간과 구성요소와 리소스를 모니터링 한다.

  튜닝은 반복적인 과정을 따라야 한다. 테스트는 가상 환경에서 재현 가능 하도록 하며, 성능에 문제될 요소를 찾았을 경우 튜닝 단계에 들어간다. 튜닝 단계가 완료되면 변경한 부분이 적용되며 테스트에 실패할 경우 변경된 튜닝을 폐기한다.

  **성능 테스팅**은 확장성과 시스템의 안정성, 속도를 검증하거나 결정한다.  또한 응답시간과 처리량, 리소스 활용도도 달라진다.  **부하 테스팅**은 가동 중에 예측한 부하 크기일 경우에 시스템의 성능 특성이 유효한지 초점을 둔다. **스트레스 테스팅**은 예상 이상의 조건일 경우에 시스템의 성능 특성을 검증하는데 초점을 둔다.

  베이스 라인을 이용하면 다양한 빌드, 버전에서 성능이 증가하는지 감소하는지 편차를 찾을 수 있다. 또한 베이스라인은 특별한 구성을 제외하고는 변하지 않아야 한다.

  - 시스템, 구성요소, 어플리케이션을 위한 베이스라인을 생성할 수 있다.
  - 베이스 라인은 비교를 위한 기준으로 세팅하며, 최적화 또는 회귀를 추적할 수 있다.
  - 베이스 라인은 성능 변화에 도울 수 있다.
  - 베이스 라인은 재 사용할 수 있어야 한다.
  - 베이스 라인은 지표다.

  벤치마킹은 다른 시스템의 성능과 비교하는 과정이다.  어플리케이션들의 벤치마크 점수를 결정하는데 필요한 성능 지표를 캡쳐하기 위해서 벤치마크 명세서를 준수하여 테스트 한다. 벤치마킹의 고려사항은 룰에 맞춰 행동해야 하며,  투명할 수 있다. 또한 다양한 메트릭의 결과를 알려줘야 한다.

  성능테스트는 시스템의 병목현상을 알려주고, 추후의 테스팅의 베이스라인을 만들어주며, 성능 튜닝의 효과를 지원하고 요구사항과 성능 목표를 준수하는지 결정에 도움을 준다. 또한 개발 수명 주기에 성능 테스트를 일찍 추가하면 프로젝트의 상당한 가치를 추가할 수 있다.

  ​

  ### chapter2 성능 테스트 종류 정리, 어떤 상황에서 필요한가

  #### 목적

  다양한 타입의 성능 테스트를 배우고 장점과 가치와 잠재적인 단점을 이해한다.

  #### 개요

  각각의 성능 테스트는 구체적인 문제 영역을 다루고 이점과 위험과 도전을 제공한다. 성능과 관련된 테스팅의 몇몇의 일반적인 타입 또는 카테고리와 관련된 프로젝트의 위험과 이점을 정의와 개요를 설명한다. 이번 장을 통해서 팀내에서 사용되는 성능 테스트 용어의 잦은 오해를 해결할 수 있을것이다.

  #### chapter2 사용법

  이 장을 통해 성능과 관련된 테스팅의 다양한 타입을 이해한다. 테스팅의 결과와 걱정, 현재의 위험을 기반으로 두어 주어진 프로젝트에 가치를 더할 수 있는 성능 테스트의 유형을 결정하는데 도움을 줄 것이다. 

  - '성능 테스팅의 주요 타입'섹션을 통해 특정 우려하는 것과 가장 관련된 테스팅의 타입을 결정하여 많은 정보를 얻고 테스트 타입 사이에 밸런스를 맞춘다.
  - '주요 성능 테스트 타입별 이점 요약 지표'섹션을 통해 특정 유형 테스팅의 이점 뿐만 아니라 성능 테스트 타입의 적절히 다루지 못하는 우려사항도 고려해봐라
  - '추가 용어와 개념'섹션을 통해 프로젝트의 가치를 더할 수 있는 성능 테스트 타입을 더 알게되고 특정 범주 외에 사람들과 대화를 통해 능력을 향상시킨다.

  성능 테스트는 테스트중인 제품의 확장성과 안정성, 속도를 검증하고 결정하기 위한 기술적인 조사라고 정의한다.성능과 관련된 튜닝과 테스팅은 테스트중인 어플리케이션의 성능 목표를 충족시키기 위해 응답시간, 처리량, 리소스 사용 수준 달성과 관련이 있다. 

  #### '성능 테스팅의 주요 타입'

  - 성능 테스트 
    - 안정성, 확장성, 속도를 검증 또는 결정
    - 테스트 중인 제품의 안정성, 확장성, 속도, 응답성을 검증, 결정하기 위해 기술적인 조사
  - 부하 테스트
    - 부하 조건이 최대 또는 정상일 때 응용프로그램의 행동을 확인한다.
    - 응용 프로그램이 원하는 성능 목표를 확인할 때 수행된다. 부하 조건이 최대일때 발생한다고 가정하여 중단점을 확인하고 응답 시간과 처리량, 리소스 사용 수준을 측정할 수 있다. 
    - 내구성 테스팅은 MTBF(Mean Time Between Failure), MTFT(Mean Time To Failure)를 통해 계산하는데 사용될 수 있다.
  - 스트레스 테스트
    - 부하 조건이 최대 또는 정상을 넘어 푸쉬될때 어플리케이션의 행동을 확인하거나 검증한다.
    - 스트레스 테스팅의 목표는 높은 부하 조건에서의 어플리케이션의 버그를 밝히는 것이다. 버그로는 동기화 이슈, 레이스 컨디션, 메모리 릭 같은것이 포함된다.
    - 스파이크 테스팅은 스트레스 테스팅 중 하위 집합이며, 짧은 시간안에 지속적으로 부하를 늘려 테스트 중인 제품의 성능을 결정하거나 검증하는데 초점을 맞춥니다. ( 순간적으로 사용자 수 늘리기 )
  - 수용량 테스트
    - 주어진 시스템의 트랜잭션이나 유저를 얼마나 많이 지원하는지 결정하고 계속해서 성능 목표를 달성한다.
    - 해당 테스트를 통해 스케일 업을 해야되는지 스케일 아웃을 해야되는지 결정한다.

  #### '주요 성능 테스트 타입별 이점 요약 지표'

  - 성능 테스트
    - 어플리케이션의 속도와 확정성, 안정성을 결정하여 비즈니스 결정 input을 제공한다.
    - 시스템의 사용자가 성능에 만족하는지 초점을 둔다.
    - 튜닝과 수용력 계획과 최적화 효과를 제공한다.
    - 로드시에 발생하는 기능적 결험을 발견하지 못할수도 있다.
  - 부하 테스트
    - 예상된 최대 부하일 때 필요한 처리량을 결정한다.
    - 하드웨어 환경과 적합한지 결정한다.
    - 로드 밸런서가 적절한지 평가한다.
    - 동시성 문제를 감지한다.
    - 부하중인 기능 오류를 감지한다.
    - 응답 속도에 주로 초점으로 두지 않도록 한다.
    - 결과는 무조건 다른 관련 부하 테스트와 비교하기 위해 사용된다. ~하기위해서사용된다.
  - 스트레스 테스트
    - 시스템의 과부하때문에 데이터가 손상될 지 결정한다.
    - 실패, 오류, 속도 저하 발생 시키기 전에 어플리케이션이 얼마나 많이 부하를 넘는지 추정한다.
    - 장애의 경고를 알려주기 위해 어플리케이션-모니터링 트리거 설정을 허용한다.
    - 얼마나 많은 스트레스가 적용 가치를 아는것은 종종 어렵다.
    - 테스트 환경을 고립시키지 않으면 심각한 중단, 네트워크 장애를 일으킬 가능성이 있다.
  - 수용량 테스트
    - 비즈니스 요구사항을 만족하기 위한 작업 부하를 다룰 수 있는 방법을 제공한다.
    - 수용량 모델 검증 테스트를 만드는건 어렵다.
    - 수용량을 검증하거나 향상시키기 위해 사용할 수 있는 실제 데이터를 제공하고, 예측을 비교하기 위한 다양한 테스트를 수행할 수 있다.

  #### '추가 용어와 개념'

  - Compenent test 
    - 어플리케이션의 아키텍쳐 구성 요소를 타겟으로 성능 테스트를 실시하는 것. 일반적인 구성요소로는 서버, DB, 네트워크, 방화벽, 클라이언트, 저장 기기이다.
  - Investigation (조사)
    - 상품의 질을 올리거나 결정하는 가치를 가질 수 있는 테스트 중인 제품의 안정성, 확장성, 속도와 관련된 정보를 모으는데 기반을 둔 활동이다.
  - Smoke Test
    - 정상적인 부하에서 작업을 수행할 수 있는지 성능 테스트의 초기 실행이다.
  - Unit Test
    - 응용 프로그램의 전체 기존 코드에서 하위 집합인 코드 모듈을 대상으로 하는 테스트다. 특정 함수, 루틴, 객체 등이 포함된다.
  -  Validation Test
    - 테스트 중인 제품의 안정성, 확장성, 속도를 추정된 기대치와 비교한다.

  ​

  ### Chapter3. 성능 테스트시 어떤 위험사항이 있을까

  속도, 확장성, 안정성 세가지의 카테고리로 해결할 수 있는 위험을 고려하는 것이 중요하다.

  - Capacity
    - 정상 또는 최대 부하 상태일때 시스템 용량이 비즈니스 볼륨을 충족하는가?
  - Compennet
    - 구성요소는 기대치를 충족하는가? 
    - 합리적으로 최적화가 잘 되있는가? 
    - 구성요소로 인한 성능 이슈가 관찰되는가?
  - Endurance
    - 성능이 시간이 지나도 동일하게 유지가 되는가?
    - 성능을 느리게 성장하는 문제를 아직 발견하지 못했는가?
  - Investigation
    - 시간에 따른 성능 트렌드를 파악하는 방법은 어떤건가요?
  - Load
    - DB,파일 서버에서 다룰 수 있는 데이터 양은 얼마나 많나요?
    - 네트워크 구성요소는 적절한가요?
  - Smoke
    - 추가적인 성능 테스트를 위해 빌드가 준비되어 있나요? 다음에는 어떤 성능 테스트를 수행하나요?
  - Spike
    - 만약 예상했던 최대 부하를 초과하면 생산 부하는 어떤일이 발생하나요?
  - Stress
    - 만약 예상했던 부하를 초과하면 생산 부하는 어떤일이 발생하나요?
  - Unit
    - 코드의  세그먼트가 합리적으로 효율적인가?
  - Validation
    - 어플리케이션이 요구사항과 목표를 충족하는가?
    - 이 버전이 이전 버전보다 빠르거나 느린가?

  #### 속도 관련 위험

  속도 관련 위험은 유저가 먼저 생각하는 것 일지라도 유저 만족도에 국한되지 않는다. 속도는 비즈니스, 데이타 관련 위험 요소이기도 하다.  속도 문제를 성능 테스트로 해결 할 수 있는것들은 다음과 같다. 

  - 어플리케이션이 유저를 만족시킬만큼 빠른가?
  - 어플리케이션이 최신 정보를 제공할 수 있는가?
  - 에러가 나기 전에 예상된 최대 응답 시간시간 내에 응답하는가?

  이를 해결 또는 완화하기 위한 방법으로는 다음과 같다.

  - 경쟁 제품 또는 버전과 속도를 비교해봐라
  - 정상 또는 최대 부하일때의 워크로드를 복제하여 부하 테스트를 설계해봐라 ( 사용량이 급증할때의 상황을 비슷하게 만들고 테스트 )
  - 성능 테스트 결과를 투자자들에게 도움을 요청해라
  - 예상된 최대 부하 상태에서 사용자들에게 피드백을 얻어봐라
  - 성능 테스트에 시간이 중요한 트랜잭션을 포함하라
  - 다양한 조건에서 부하 수준, 시나리오를 혼합해서 속도 측정을 해봐라 ( 사용자는 변함없는 속도에 중요하게 생각함 )

  #### 확장성 관련 위험

  어플리케이션이 지원할 수 있는 유저의 수 뿐만 아니라 어플리케이션이 포함하고 처리할 수 있는 데이터의 양, 용량에 도달하기 까지의 시기를 확인할 수 있는 기능과 관련이 있다.

  - 전체 유저를 위한 받아들일 수 있는 응답 시간과 일관되게 제공을 할 수 있는가?
  - 어플리케이션의 생명 주기 동안 수집된 데이터를 저장할 수 있는가?
  - 최대 용량에 다 다랐을때 경고를 알려주는가?
  - 헤비 사용량에 어플리케이션이 여전히 안전한가?
  - 헤비 사용량에 기능이 손실되는가?
  - 예상치 못한 최대 부하를 견딜 수 있는가?

  완화 하는 전략으로는 다음과 같다.

  - 다양한 부하에서 측정된 속도를 비교하라
  - 예상된 최대 시간과 일반적인 상황에서 워크로드를 복제하여 부하 테스트를 설계하라
  - 실제 요구사항에 매핑되는 의미있는 성능 테스트를 한다.
  - 실제 생산중에 수행되는 비즈니스 운영과 비슷한 용량, 타입, 유통으로 성능 테스트를 실시하라.

  #### 안정성 관련 위험

  안정성은 회복 능력, 가동 시간, 신뢰성과 같은 전반적인 용어이다. 안정성 위험은 안정성 이슈, 내구성, 고부하 ,스트레스 테스트와 함께 일반적으로 해결되는데 가장 기본적인 성능 테스트에서 안정성 이슈가 때때로 감지된다.

  - 데이터 손상, 속도 저하 없이 오래 시간동안 어플리케이션이 구동되는가?
  - 만약 예기치않은 오류로 다운되면 부분적으로 완료된 트랜잭션은 어떻게 되는가?
  - 시스템을 다운시키지 않고 업데이트를 할 수 있는가?
  - 반복적인 기능적 오류의 조합으로 시스템 충돌이 일어날 수 있는가?
  - 예기치 않게 시스템이 중단된 경우 다시 정상적으로 작동을 할 때  올바른 시점에 작동할 수 있는가?

  완화 전략으로는 다음과 같다.

  - 현실적인 내구성 테스트를 위한 시간을 만들어라
  - 주요 시나리오로 스트레스 테스팅을 실시해라 ( 비즈니스 지표 참고 )
  - 오프라인 테스트를 실시하여 데이터 무결성, 성능, 기능을 관찰하라
  - 성능 테스트 중에 패치를 적용한다.
  - 성능 테스트중에 바이러스/백업을 강제로 실시해봐라
  - 성능 테스트 시나리오에 오류와 예외상황을 추가하라.

